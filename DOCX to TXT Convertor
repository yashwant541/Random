import dataiku
from docx import Document
import os

# Get Dataiku folders
input_folder = dataiku.Folder("input_folder")
output_folder = dataiku.Folder("output_folder")

# Get paths
input_path = input_folder.get_path()
output_path = output_folder.get_path()

# Loop through files in input folder
for file_name in os.listdir(input_path):
    if file_name.lower().endswith(".docx"):
        docx_file_path = os.path.join(input_path, file_name)

        # Read DOCX
        document = Document(docx_file_path)

        # Extract text
        full_text = []
        for para in document.paragraphs:
            full_text.append(para.text)

        # Output file name
        txt_file_name = file_name.replace(".docx", ".txt")
        txt_file_path = os.path.join(output_path, txt_file_name)

        # Write TXT
        with open(txt_file_path, "w", encoding="utf-8") as f:
            f.write("\n".join(full_text))

        print(f"Converted: {file_name} â†’ {txt_file_name}")
